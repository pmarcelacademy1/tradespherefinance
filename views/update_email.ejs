<%- include('partials/dynaHeader')%>

<main style="min-height: 100vh;">
  <div class="fade-appear-done fade-enter-done">
    <div class="row">
      <div class="col l6 offset-l3 s12">
        <div class="card-panel">
          <center>
            <h3 style="color: #286090;">Update Email</h3>
            <p>Current Email: <strong><%= user.email %></strong></p>

            <!-- Flash Messages -->
            <% if (messages.error) { %>
              <div class="flash-message" style="background-color: #ffebee; color: #c62828; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                <%= messages.error %>
              </div>
            <% } %>
            <% if (messages.success) { %>
              <div class="flash-message" style="background-color: #e8f5e9; color: #2e7d32; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                <%= messages.success %>
              </div>
            <% } %>

            <!-- Form -->
            <form action="/update_email/<%= user._id %>" method="POST">
              <!-- New Email -->
              <div class="input-field">
                <input 
                  type="email" 
                  name="newEmail" 
                  maxlength="225" 
                  required 
                  id="newEmail"
                >
                <label for="newEmail">New Email</label>
              </div>

              <!-- Password -->
              <div class="input-field">
                <input 
                  type="password" 
                  name="password" 
                  minlength="6" 
                  required 
                  id="password"
                >
                <label for="password">Confirm Password</label>
              </div>

              <!-- Submit Button -->
              <div>
                <button 
                  type="submit" 
                  style="background-color: #286090; color: white; padding: 10px 72px; border: none; border-radius: 30px; font-size: 16px; font-weight: bold; margin-top: 15px;"
                >
                  Update
                </button>
              </div>
            </form>
          </center>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      document.querySelectorAll('.flash-message').forEach(function(el) {
        el.style.transition = 'opacity 0.5s';
        el.style.opacity = '0';
        setTimeout(() => el.remove(), 500);
      });
    }, 4000);
  });
</script>

<%- include('partials/dynaFooter')%>