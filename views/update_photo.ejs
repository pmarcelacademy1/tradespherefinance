<%- include('partials/dynaHeader')%>



<main style="min-height: 100vh;">
  <div class="fade-appear-done fade-enter-done">
    <div class="row">
      <div class="col l6 offset-l3 s12">
        <div class="card-panel app-py-1">
          <center>
            <h3 style="color: #286090;">Update Profile Photo</h3>
            <p>Upload a new profile picture (JPG, PNG, or JPEG).</p>

            <!-- Current Profile Picture -->
            <% if (user && user.image) { %>
              <img src="/IMG_UPLOADS/<%= user.image %>" class="circle" height="100px" alt="Profile Picture">
            <% } else { %>
              <img src="/static/account/assets/images/user.png" class="circle" height="100px" alt="Default Profile Picture">
            <% } %>

            <!-- Flash Messages -->
            <% if (messages.error) { %>
              <div class="flash-message" style="background-color: #ffebee; color: #c62828; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                <%= messages.error %>
              </div>
            <% } %>
            <% if (messages.success) { %>
              <div class="flash-message" style="background-color: #e8f5e9; color: #2e7d32; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                <%= messages.success %>
              </div>
            <% } %>

            <!-- Form -->
            <form action="/update_photo/<%= user._id %>" method="POST" enctype="multipart/form-data">
              <div class="file-field input-field">
                <div style="background-color: #286090; color: white; padding: 8px 16px; border-radius: 4px;">
                  <span>Select Photo</span>
                  <input type="file" name="profile_image" accept=".jpg,.png,.jpeg" required id="photo">
                </div>
                <div class="file-path-wrapper">
                  <input class="file-path validate" type="text" placeholder="Choose a file">
                </div>
              </div>

              <div>
                <button 
                  type="submit" 
                  style="background-color: #286090; color: white; padding: 10px 72px; border: none; border-radius: 30px; font-size: 16px; font-weight: bold; margin-top: 15px;"
                >
                  Update
                </button>
              </div>
            </form>
          </center>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      document.querySelectorAll('.flash-message').forEach(function(el) {
        el.style.transition = 'opacity 0.5s';
        el.style.opacity = '0';
        setTimeout(() => el.remove(), 500);
      });
    }, 4000);
  });
</script>




<%- include('partials/dynaFooter')%>